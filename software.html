<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relatify - Software</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+Bhai+2&display=swap" rel="stylesheet">
<style>
body { font-family: 'Baloo Bhai 2', Comic Sans MS, sans-serif; background:#121212; color:#fff; margin:0; padding:0; }
header { background:#1A237E; padding:20px; font-size:2rem; font-weight:bold; color:#fff; position: sticky; top: 0; z-index: 1000; display:flex; justify-content:space-between; align-items:center; }
.menu-bar { cursor:pointer; font-size:1.5rem; }
.search-box { display:flex; justify-content:flex-end; flex:1; margin-left:20px; position:relative; }
#searchInput { padding:10px 12px; border-radius:10px; border:none; width:250px; font-size:1rem; background:#fff; color:#000; box-shadow:0 2px 5px rgba(0,0,0,0.3); }
#searchInput:focus { outline:none; border:2px solid #00BFA5; box-shadow:0 0 15px #00BFA5; transition:0.3s; }
.autocomplete-items { position:absolute; top:100%; left:0; right:0; background:#fff; z-index:999; border-radius:0 0 10px 10px; max-height:200px; overflow-y:auto; color:#000; }
.autocomplete-items div { padding:8px 10px; cursor:pointer; }
.autocomplete-items div:hover { background:#00BFA5; color:#fff; }
.category-dropdown { display:none; flex-direction:column; background:#1E1E1E; margin-top:5px; padding:5px 0; border-radius:10px; }
.category-dropdown button { background:#2A2A3A; color:#fff; border:none; margin:3px 10px; padding:8px; border-radius:8px; cursor:pointer; }
.category-dropdown button:hover { background:#00BFA5; }
.grid-container { width:100%; max-width:1200px; margin:15px auto; }
.grid { display:grid; grid-template-columns: repeat(3,1fr); gap:20px; justify-items:center; }
@media(max-width:900px){ .grid { grid-template-columns: repeat(3,1fr); } }
.card { background:#1E1E1E; padding:15px; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.5); width:100%; max-width:250px; text-align:center; }
.card img { width:100%; border-radius:10px; margin-bottom:12px; }
.card h3 { color:#00BFA5; font-size:1.2rem; margin-bottom:8px; }
.card p { font-size:0.9rem; color:#ccc; margin-bottom:12px; }
.card a { background:#00BFA5; color:#fff; padding:8px 18px; border-radius:8px; text-decoration:none; font-size:0.95rem; display:inline-block; transition:background 0.3s; }
.card a:hover { background:#26A69A; }
mark { background: #FFD600; color:#000; padding:0 2px; border-radius:2px; }
.no-results { opacity:0; transition:0.3s; color:#FFD600; font-size:1.3rem; margin-top:15px; text-align:center; }
.no-results.visible { opacity:1; }
footer { margin-top:30px; padding:12px; background:#1A237E; color:#fff; font-size:0.9rem; text-align:center; }
</style>
</head>
<body>

<header>
    <div class="menu-bar" id="menuBtn">&#9776;</div>
    <div class="search-box autocomplete">
        <input type="text" id="searchInput" placeholder="Search for software...">
        <div id="autocomplete-list" class="autocomplete-items"></div>
    </div>
</header>

<div class="category-dropdown" id="categoryDropdown"></div>

<div class="grid-container">
    <div class="grid" id="productGrid"></div>
    <div class="no-results" id="noResults">No products found</div>
</div>

<footer>&copy; 2025 Relatify</footer>

<script>
// Silent redirect if not subscribed
if(sessionStorage.getItem('formSubmitted') !== 'true'){
    window.location.href = "index.html";
}

const menuBtn = document.getElementById('menuBtn');
const categoryDropdown = document.getElementById('categoryDropdown');
const searchInput = document.getElementById('searchInput');
const autocompleteList = document.getElementById('autocomplete-list');
const productGrid = document.getElementById('productGrid');
const noResults = document.getElementById('noResults');

let products = [];
let categories = [];

// Toggle menu
menuBtn.addEventListener('click', () => {
    categoryDropdown.style.display = categoryDropdown.style.display==='flex'?'none':'flex';
    renderProducts(products, ''); // empty page only if menu active?
});

// Fetch products & categories
async function loadData(){
    try{
        const resProducts = await fetch('products.json');
        products = await resProducts.json();
        const resCategories = await fetch('category.json');
        categories = await resCategories.json();
        renderCategoryButtons();
        renderProducts(products,'');
    }catch(e){ console.error(e); noResults.textContent="Failed to load products"; noResults.classList.add('visible'); }
}

// Render category buttons
function renderCategoryButtons(){
    categoryDropdown.innerHTML='';
    categories.forEach(cat=>{
        const btn = document.createElement('button');
        btn.textContent = cat.name;
        btn.addEventListener('click',()=>{
            categoryDropdown.style.display='none';
            const allowed = new Set(cat.products.map(p=>p));
            const filtered = products.filter(p=>allowed.has(p.name));
            renderProducts(filtered,'');
        });
        categoryDropdown.appendChild(btn);
    });
}

// Render products
function renderProducts(list, query){
    productGrid.innerHTML='';
    if(query){
        const q = query.toLowerCase();
        list = list.filter(p=>p.name.toLowerCase().includes(q) || p.description.toLowerCase().includes(q));
    }
    if(list.length===0){ noResults.classList.add('visible'); return; }
    noResults.classList.remove('visible');
    list.forEach(p=>{
        const card = document.createElement('div'); card.className='card';
        card.innerHTML=`<img src="${p.img}" alt="${p.name}"><h3>${p.name}</h3><p>${p.description}</p><a href="${p.link}" target="_blank">Get Here</a>`;
        productGrid.appendChild(card);
    });
}

// Autocomplete
searchInput.addEventListener('input', function(){
    const val = this.value.toLowerCase();
    autocompleteList.innerHTML='';
    if(!val) return;
    const matches = products.filter(p=>p.name.toLowerCase().includes(val)).slice(0,5);
    matches.forEach(m=>{
        const div = document.createElement('div');
        div.textContent = m.name;
        div.addEventListener('click',()=>{
            searchInput.value = m.name;
            autocompleteList.innerHTML='';
            renderProducts(products,m.name);
        });
        autocompleteList.appendChild(div);
    });
});

// Enter key
searchInput.addEventListener('keydown', e=>{
    if(e.key==='Enter'){ autocompleteList.innerHTML=''; renderProducts(products,searchInput.value); }
});

loadData();
</script>

</body>
</html>
