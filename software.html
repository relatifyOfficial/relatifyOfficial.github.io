<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relatify - Software</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+Bhai+2&display=swap" rel="stylesheet">
<style>
body { font-family: 'Baloo Bhai 2', Comic Sans MS, sans-serif; background:#121212; color:#fff; margin:0; padding:0; text-align:center; }
header { background:#1A237E; padding:20px; font-size:2rem; font-weight:bold; color:#fff; position: sticky; top:0; z-index:1000; display:flex; justify-content:space-between; align-items:center; }
.menu-btn { font-size:1.8rem; cursor:pointer; }
main { padding:15px; display:flex; flex-direction:column; align-items:center; }
h2 { color:#FFD600; font-size:1.8rem; margin-bottom:15px; }
.search-box { width:100%; display:flex; justify-content:center; padding:8px 0; margin-bottom:10px; }
.search-box input { padding:10px 12px; border-radius:10px; border:none; width:90%; max-width:320px; font-size:1rem; background:#fff; color:#000; box-shadow:0 2px 5px rgba(0,0,0,0.3); }
.search-box input::placeholder { color:#888; }
.grid-container { width:100%; max-width:1000px; margin-top:15px; position:relative; }
.grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:20px; justify-items:center; }
@media(max-width:900px){ .grid { grid-template-columns: repeat(2,1fr); gap:15px; } }
@media(max-width:600px){ .grid { grid-template-columns: 1fr; gap:12px; } }
.card { background:#1E1E1E; padding:15px; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.5); width:100%; max-width:250px; text-align:center; opacity:0; transform: translateY(15px); transition: opacity 0.3s ease, transform 0.3s ease; }
.card.visible { opacity:1; transform: translateY(0); }
.card img { width:100%; border-radius:10px; margin-bottom:12px; }
.card h3 { color:#00BFA5; font-size:1.2rem; margin-bottom:8px; }
.card p { font-size:0.9rem; color:#ccc; margin-bottom:12px; }
.card a { background:#00BFA5; color:#fff; padding:8px 18px; border-radius:8px; text-decoration:none; font-size:0.95rem; display:inline-block; transition:background 0.3s; }
.card a:hover { background:#26A69A; }
mark { background: #FFD600; color:#000; padding:0 2px; border-radius:2px; }
.no-results { opacity:0; transition: opacity 0.3s ease; color:#FFD600; font-size:1.3rem; margin-top:15px; text-align:center; }
.no-results.visible { opacity:1; }

/* Side menu */
.side-menu { position:fixed; top:0; left:-220px; width:200px; height:100%; background:#1A237E; overflow-y:auto; padding-top:60px; transition:left 0.3s ease; z-index:2000; display:flex; flex-direction:column; }
.side-menu button { background:#1E1E1E; color:#fff; border:none; padding:12px 15px; margin:5px; border-radius:8px; cursor:pointer; font-size:1rem; text-align:left; transition: background 0.3s; }
.side-menu button:hover { background:#00BFA5; color:#fff; }
.side-menu.show { left:0; }

/* Overlay when menu open */
.overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); opacity:0; visibility:hidden; transition:opacity 0.3s; z-index:1500; }
.overlay.show { opacity:1; visibility:visible; }

footer { margin-top:30px; padding:12px; background:#1A237E; color:#fff; font-size:0.9rem; }
@media(max-width:400px){ header { font-size:1.6rem; padding:15px; } .search-box input { font-size:0.95rem; padding:8px 10px; } .card a { font-size:0.9rem; padding:6px 15px; } }
</style>
</head>
<body>

<header>
    Relatify
    <span class="menu-btn" id="menuBtn">&#9776;</span>
</header>

<div class="side-menu" id="sideMenu"></div>
<div class="overlay" id="overlay"></div>

<main>
  <h2>ðŸ’» Softwares</h2>

  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Search for software...">
  </div>

  <div class="grid-container">
    <div class="grid" id="productGrid"></div>
    <div class="no-results" id="noResults">No products found</div>
  </div>
</main>

<footer>&copy; 2025 Relatify</footer>

<script>
// Redirect if not subscribed
if(sessionStorage.getItem('formSubmitted') !== 'true'){
    window.location.href = "index.html";
}

const grid = document.getElementById('productGrid');
const noResults = document.getElementById('noResults');
const matchCount = document.createElement('div');
matchCount.style.color = '#FFD600';
matchCount.style.margin = '10px 0';
document.querySelector('main').insertBefore(matchCount, grid.parentNode);
const searchInput = document.getElementById('searchInput');
const sideMenu = document.getElementById('sideMenu');
const overlay = document.getElementById('overlay');
const menuBtn = document.getElementById('menuBtn');

let products = [];
let categories = [];

// Toggle side menu
menuBtn.addEventListener('click', () => {
    sideMenu.classList.toggle('show');
    overlay.classList.toggle('show');
});
overlay.addEventListener('click', () => {
    sideMenu.classList.remove('show');
    overlay.classList.remove('show');
});

// Fetch data
async function loadData(){
    try {
        products = await (await fetch('products.json')).json();
        categories = await (await fetch('category.json')).json();
        renderSideMenu();
        renderProducts(products);
    } catch(e){
        console.error(e);
        noResults.textContent = "Failed to load products";
        noResults.classList.add('visible');
    }
}

// Render side menu categories
function renderSideMenu(){
    categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat.name;
        btn.addEventListener('click', () => {
            sideMenu.classList.remove('show');
            overlay.classList.remove('show');
            const filtered = products.filter(p => cat.products.includes(p.name));
            renderProducts(filtered);
        });
        sideMenu.appendChild(btn);
    });
}

// Highlight text
function highlight(text, query){
    if(!query) return text;
    const regex = new RegExp(`(${query.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi');
    return text.replace(regex,'<mark>$1</mark>');
}

// Render products with fade animation
function renderProducts(filteredProducts, searchQuery=''){
    const filtered = searchQuery 
        ? filteredProducts.filter(p => p.name.toLowerCase().includes(searchQuery) || p.description.toLowerCase().includes(searchQuery))
        : filteredProducts;

    const existingCards = Array.from(grid.children);

    // Fade out old cards
    existingCards.forEach(card => {
        const name = card.querySelector('h3').textContent.replace(/<[^>]+>/g,'');
        if(!filtered.some(p => p.name === name)){
            card.classList.remove('visible');
            setTimeout(() => card.remove(), 300);
        }
    });

    // Add new cards
    filtered.forEach(product => {
        if(!existingCards.some(card => card.querySelector('h3').textContent.replace(/<[^>]+>/g,'') === product.name)){
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <img src="${product.img}" alt="${product.name}">
                <h3>${searchQuery ? highlight(product.name, searchQuery) : product.name}</h3>
                <p>${searchQuery ? highlight(product.description, searchQuery) : product.description}</p>
                <a href="${product.link}" target="_blank" rel="noopener noreferrer">Get Here</a>
            `;
            grid.appendChild(card);
            setTimeout(() => card.classList.add('visible'), 10);
        }
    });

    matchCount.textContent = filtered.length > 0 ? `${filtered.length} product${filtered.length>1?'s':''} found` : '';
    noResults.classList.toggle('visible', filtered.length === 0);
}

// Search input
searchInput.addEventListener('input', () => {
    renderProducts(products, searchInput.value.toLowerCase());
});

// Initialize
loadData();
</script>

</body>
</html>
