<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relatify - Software</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+Bhai+2&display=swap" rel="stylesheet">
<style>
body { font-family: 'Baloo Bhai 2', Comic Sans MS, sans-serif; background:#121212; color:#fff; text-align:center; margin:0; padding:0; }
header { background:#1A237E; padding:20px; font-size:2rem; font-weight:bold; color:#fff; position: sticky; top: 0; z-index: 1000; }
main { padding:15px; display:flex; flex-direction:column; align-items:center; }
h2 { color:#FFD600; font-size:1.8rem; margin-bottom:15px; }

/* Sticky search */
.search-box { width:100%; display:flex; justify-content:center; position: sticky; top: 60px; background:#121212; padding: 8px 0; z-index: 1001; margin-bottom:10px; }
#searchInput {
    padding: 10px 12px;
    border-radius: 10px;
    border: 2px solid #00BFA5; /* Highlight border color */
    width:90%;
    max-width:320px;
    font-size:1rem;
    background:#fff;
    color:#000;
    position: relative;
    z-index: 1001;
    box-shadow: 0 0 15px rgba(0,191,165,0.7); /* Glow effect */
    transition: box-shadow 0.3s, border-color 0.3s;
}
#searchInput:focus {
    outline: none;
    border-color: #FFD600;  /* Brighter border on focus */
    box-shadow: 0 0 20px rgba(255,214,0,0.9); /* Brighter glow */
}
#searchInput::placeholder { color:#888; }

/* Menu */
.category-menu { position: fixed; left: 0; top: 60px; width: 250px; background:#1E1E1E; padding: 10px; height: 100%; overflow-y: auto; transform: translateX(-260px); transition: transform 0.3s ease; z-index: 1000; }
.category-menu.show { transform: translateX(0); }
.category-menu button { display:block; width:100%; background:#2A2A3A; color:#fff; border:none; padding:10px; margin:5px 0; border-radius:5px; cursor:pointer; font-size:1rem; }
.menu-toggle { position: fixed; top: 65px; left: 10px; font-size: 2rem; color: #00BFA5; background: none; border: none; cursor: pointer; z-index: 1002; }

/* Grid */
.grid-container { width:100%; max-width:1200px; margin-top:15px; }
.grid { display: grid; grid-template-columns: repeat(3, 1fr); gap:20px; justify-items:center; }
.card { background:#1E1E1E; padding:15px; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.5); width:100%; max-width:300px; text-align:center; opacity:0; transform: translateY(15px); transition: opacity 0.3s ease, transform 0.3s ease; }
.card.visible { opacity:1; transform: translateY(0); }
.card img { width:100%; border-radius:10px; margin-bottom:12px; }
.card h3 { color:#00BFA5; font-size:1.2rem; margin-bottom:8px; }
.card p { font-size:0.9rem; color:#ccc; margin-bottom:12px; }
.card a { background:#00BFA5; color:#fff; padding:8px 18px; border-radius:8px; text-decoration:none; font-size:0.95rem; display:inline-block; transition:background 0.3s; }
.card a:hover { background:#26A69A; }

/* Highlight */
mark { background: #FFD600; color:#000; padding:0 2px; border-radius:2px; }

/* No products message */
.no-results { opacity:0; transition: opacity 0.3s ease; color:#FFD600; font-size:1.3rem; margin-top:15px; text-align:center; }
.no-results.visible { opacity:1; }

footer { margin-top:30px; padding:12px; background:#1A237E; color:#fff; font-size:0.9rem; }

@media(max-width:900px){ .grid { grid-template-columns: repeat(3,1fr); gap:15px; } }
@media(max-width:600px){ .grid { grid-template-columns: repeat(3,1fr); gap:12px; } }
</style>
</head>
<body>

<header>Relatify</header>

<!-- Menu toggle -->
<button class="menu-toggle">&#9776;</button>

<div class="category-menu" id="categoryMenu"></div>

<main>
  <h2>ðŸ’» Softwares</h2>

  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Search for software...">
  </div>

  <div class="match-count" id="matchCount"></div>

  <div class="grid-container">
    <div class="grid" id="productGrid"></div>
    <div class="no-results" id="noResults">No products found</div>
  </div>
</main>

<footer>&copy; 2025 Relatify</footer>

<script>
// Silent redirect if not subscribed
if(sessionStorage.getItem('formSubmitted') !== 'true'){
    window.location.href = "index.html";
}

// Menu toggle
const menuToggle = document.querySelector('.menu-toggle');
const categoryMenu = document.getElementById('categoryMenu');
menuToggle.addEventListener('click', () => {
    categoryMenu.classList.toggle('show');
});

const grid = document.getElementById('productGrid');
const noResults = document.getElementById('noResults');
const matchCount = document.getElementById('matchCount');
const searchInput = document.getElementById('searchInput');
let products = [];
let categories = [];

// Fetch products and categories
async function loadData() {
  try {
    const resProducts = await fetch('products.json');
    products = await resProducts.json();

    const resCategories = await fetch('category.json');
    categories = await resCategories.json();

    renderCategoryMenu();
    renderProducts(products, '');
  } catch (err) {
    console.error('Failed to load data', err);
    noResults.textContent = "Failed to load products";
    noResults.classList.add('visible');
  }
}

// Render categories in side menu
function renderCategoryMenu() {
    categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat.name;
        btn.addEventListener('click', () => {
            renderProducts(products, '', cat.id);
            categoryMenu.classList.remove('show');
        });
        categoryMenu.appendChild(btn);
    });
}

// Highlight search
function highlight(text, query) {
  if(!query) return text;
  const regex = new RegExp(`(${query.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi');
  return text.replace(regex, '<mark>$1</mark>');
}

// Render products
function renderProducts(allProducts, query, categoryId=null) {
  let filtered = allProducts;

  if(categoryId){
      const cat = categories.find(c => c.id === categoryId);
      if(cat) filtered = filtered.filter(p => cat.products.includes(p.name));
  } else if(query){
      filtered = filtered.filter(p => 
          p.name.toLowerCase().includes(query) || 
          p.description.toLowerCase().includes(query)
      );
  }

  grid.innerHTML = '';
  filtered.forEach(product => {
      const card = document.createElement('div');
      card.className = 'card visible';
      card.innerHTML = `
        <img src="${product.img}" alt="${product.name}">
        <h3>${highlight(product.name, query)}</h3>
        <p>${highlight(product.description, query)}</p>
        <a href="${product.link}" target="_blank" rel="noopener noreferrer">Get Here</a>
      `;
      grid.appendChild(card);
  });

  matchCount.textContent = filtered.length > 0 ? `${filtered.length} product${filtered.length>1?'s':''} found` : '';
  if(filtered.length === 0) noResults.classList.add('visible'); else noResults.classList.remove('visible');
}

// Event listener for search
searchInput.addEventListener('input', () => {
  renderProducts(products, searchInput.value.toLowerCase());
});

// Initialize
loadData();
</script>

</body>
</html>
